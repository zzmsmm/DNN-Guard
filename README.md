# DNN-Guard
## 黑盒NLP水印算法：
### 算法介绍
对于黑盒形式，我们构建了对于相关攻击，例如微调或者剪枝，具有较高鲁棒性的后门数据，流程如下：首先我们根据整个训练集为依据，按照词语的重要性进行排序，并对于不同标签的部分数据根据排序交换其中部分词语构建出后门载体，交换的方式有多种选择：重要性最低或最高。其次我们进行身份信息的嵌入，先按照用户独有的hash值生成一组与模型输入向量结构相同的特殊向量，并将其与构建的后门载体进行相加得到最终的后门数据，并与正常的训练数据共同训练模型，从而实现水印的嵌入。
根据实验结果，对于后门数据的加入，模型原本的准确率几乎无影响，同时这种后门对于剪枝以及微调的鲁棒性很好，完全可以胜任后门的要求。同时对于加入的身份信息，实验表明并不会影响原有后门的效果，并且对于不同用户的身份信息，能够有明显的区分度。

### 使用流程
* 用户根据数据集构建后门载体数据。
* 平台根据用户独有hash值生成特征向量作为身份信息。
* 用户本地根据身份信息以及后门载体得到最终后门数据。
* 将后门数据与原数据集共同作为训练集训练模型。并使得后门数据的准确度达到规定要求，最终上传后门数据。
* 当用户遇到疑似侵权行为用户需要将相关的黑盒模型api调用方式自行整理使得能够调用，并且上传网站，网站对于后门数据进行准确率测试，并根据结果表现做出判断。
* 网站将具备公信力的裁决结果提供给用户下载，该结果并不具备法律效力。

### 注意
对于黑盒环境下的NLP后门，在进行数据的上传时，用户需要预先根据载体数据集以及秘钥进行结合得到最终后门数据对应的向量，并按照词向量表将该向量转换为对应的句子，然后进行上传，这是因为黑盒环境下我们无法在前向传播前进行输入向量的相关操作，所以需要预先进行处理。
